<style>
    
    /* === Add Product Page === */
    .add-product-page {
            display: flex;
            justify-content: space-between;
            flex-direction: row;
            align-items: flex-start;
            width: 95%;
            margin: 20px auto;
            padding: 20px;
            border-radius: 20px;
            background-color: #9f9281;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
    
        
    /* === Main Section === */
    .Main {
            display: flex;
            flex-direction: column;
            background-color: antiquewhite;
            padding: 20px;
        }
    
        
    /* === Vendor Products === */
    .vendor-Products {
            width: 95%;
            margin: 20px auto;
            padding: 20px;
            background-color: #c1ffe0;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
    
        
    /* === Forms Holder === */
    .forms-holder {
            display: flex;
            justify-content: space-around;
            align-items: flex-start;
            width: 60%;
        }
    
        
    /* === Form Base Style === */
    .form-css {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 220px;
            max-width: 300px;
            padding: 20px;
            box-shadow: 2px 1px 2px 1px rgb(152, 152, 152);
            border-radius: 10px;
        }
    
        
    /* === Form Style 1 === */
    .form1 {
            width: 100%;
            background-color: rgb(207, 239, 239);
        }
        
    /* === Edit Form Section === */
    .edit-form {
    display: flex;
    flex-direction: row;
    justify-content: center; /* center in container */
    gap: 2rem;
    background-color: #f9f9f9;
    padding: 2rem;
    border-radius: 8px;
    border: 1px solid #ddd;
    width: 100%; /* Allow to grow full width of container */
    max-width: 1200px; /* Prevent excessive stretch on large screens */
    box-sizing: border-box;
    margin: auto; /* Center horizontally */
}

.left-side-form,
.right-side-form {
    flex: 1; /* Share space equally */
    display: flex;
    height: auto;
    flex-direction: column;
    gap: 1rem;
    min-width: 250px;
}

.edit-form label {
    font-weight: 500;
    margin-bottom: 0.3rem;
}

.edit-form input,
.edit-form select,
.edit-form textarea {
    padding: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 1rem;
    width: 100%;
}

.edit-form input[type="submit"] {
    background-color: #444;
    color: white;
    border: none;
    padding: 0.6rem;
    border-radius: 4px;
    font-weight: bold;
    cursor: pointer;
}

.edit-form input[type="submit"]:hover {
    background-color: #333;
}

    
.warranty_field_css,

/* === Discount Field Section === */
.discount_field_css {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    background-color: #f0f0f0;
    padding: 1rem;
    border-radius: 4px;
}




label {
    padding: 5px 0;
}

input[type="submit"] {
    margin-top: 10px;
    padding: 8px 12px;
    background-color: antiquewhite;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

    
/* === Sidebar of Add Product Page === */
.leftside-of-add-product-page {
        text-align: center;
        width: 20%;
    }

    
/* === Discount Field Section === */
.discount_field_css {
        display: flex;
        flex-direction: column;
        height: auto;
        align-items: center;
        width: 100%;
    }

    
/* === Warranty Field Section === */
.warranty_field_css {
        display: flex;
        flex-direction: column;
        height: auto;
        align-items: center;
        width: 100%;
    }

    .grid-products {
        display: grid;
        grid-template-columns: repeat(3, minmax(240px, 1fr));
        gap: 20px;
    }

    .product-card {
        padding: 15px;
        background-color: #fefefe;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        text-align: center;
        height: auto;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
    }

    .product-card img {
        width: 100%;
        height: auto;
        object-fit: cover;
        border-radius: 3px;
    }

    .product-card .title,
    .product-card .price {
        font-weight: bold;
        margin: 4px 0;
    }

    .inventory-button {
        background-color: antiquewhite;
        color: black;
        padding: 8px 12px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }

    .inventory-button:hover {
        background-color: #e2d1b8;
    }

    .button-holder{
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        min-height: 100px;
    }

    .img-title-holder{
        display: flex;
        width: 50%;
        flex-direction: column;
        justify-content: space-around;
        min-height: 100px;
    }
    .price-holder{
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        width: 30%;
        min-width: 150px;
        padding: 0px 20px;
        min-height: 100px;
    }
    .price-holder p{
        font-size: 13px;
    }


    /* Modal */
    #OptionsModal,
    #EditProductModal,
    #DeleteProductModal,
    #AddImageModal,
    #InventoryModal,
    #EditInventoryModal,
    #ImageModal,
    #EditImageModal {
        flex-direction: row;
        justify-content: center;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 1000;
        background-color: white;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        display: none;
    }

    .modal-dialog {
        padding: 20px;
    }

    .modal-content {
        display: flex;
        flex-direction: column;
        padding: 20px;
        border-radius: 10px;
        background-color: #f9f9f9;
    }
    .modal-body div,section{
        align-content: center;
    }

    .modal-footer {
        display: flex;
        justify-content: center;
        width: 100%;
    }
    /* ################################### */
    .Options-dialog {
        
    }
    .Options-content {
        
    }
    .Options-button-holder {
        display: flex;
        flex-direction: column;
        justify-content: space-around;
    }
    .Options-body {
        display: flex;
        justify-content: space-around;
        height: 300px;
    }
    .Options-footer {
        
    }
    /* ################################### */
    .edit-product-dialog {
        background-color: #007BFF;
        max-height: 300px;
    }
    /* ################################### */
    .delete-product-dialog {
        
    }
    /* ################################### */
    .add-image-dialog {
        
    }
    /* ################################### */
    .edit-image-content {
        width: 1200px;
    }
    .edit-image-dialog {
        
    }
    /* ################################### */
    .add-inventory-dialog {
        
    }
    /* ################################### */
    .edit-inventory-dialog {
        
    }


.btn {
    background-color: antiquewhite;
    padding: 8px 14px;
    border-radius: 5px;
    border: none;
}

.btn-primary {
    margin-top: 3%;
    background-color: antiquewhite;
}

.Inventory-form {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.discount-badge {
    position: absolute;
    top: 10px;
    left: -10px;
    background: crimson;
    color: white;
    font-weight: bold;
    padding: 5px 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    border-radius: 4px;
    font-size: 14px;
    z-index: 10;
}
.product-card {
    box-shadow: var(--BoxShadow);
    position: relative; /* Needed so the badge is positioned correctly */
}

.inventory-button{
    width: auto;
    height: 40px;
    font-size: 16px;
    cursor: pointer;
}
.edit-button{
    background-color: antiquewhite;
    width: auto;
    height: 30px;
    cursor: pointer;
    font-size: 12px;
}
.modal-button-holder{
    display: flex;
    flex-direction: column;
    justify-content: space-around;
}


.img-contrainter{
    width: auto;
    height: auto;
}
.img-contrainter-modal{
    display: flex;
    justify-content: space-around;
    width: 100%;
}

/* old thumbnail */
/* .thumbnail-bar {
    width: 100%; 
    height: auto; 
    display: flex; 
    flex-direction: row;
    gap: 10px; 
    overflow-x: auto; 
    overflow-y: hidden; 
    padding-right: 10px;
    white-space: nowrap;
    align-content: center;
    scroll-behavior: smooth; 
}
    
.thumbnail, .placeholder-thumb {
    width: 60px; 
    height: auto;
    object-fit: cover;
    border: 2px solid transparent;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 0px;
    display: flex;
    align-content: center;
} */

.thumbnail-bar {
    width: 100%;
    height: auto; 
    display: flex; 
    flex-direction: row;
    gap: 10px; 
    overflow-x: auto; 
    overflow-y: hidden; 
    padding-right: 10px;
    white-space: nowrap;
    align-content: center;
    scroll-behavior: smooth; 
}
.thumbnail-item{
    width: 45px; 
    height: auto;
    object-fit: cover;
    border: 2px solid transparent;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 0px;
    display: flex;
    align-content: center;
}

.thumbnail, .placeholder-thumb {
    width: 60px; 
    height: auto;
    object-fit: cover;
    border: 2px solid transparent;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 0px;
    display: flex;
    justify-content: space-around;
    align-content: center;
}
    
.placeholder-thumb:hover {
    /* transform: scale(1.05); */
    border-color: #007BFF;
}

.radio-group-horizontal {
    display: flex;
    flex-direction: row;
    justify-content: space-evenly;
}

.radio-option {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 0.3rem; /* spacing between input and label */
}

</style>

    
    {% extends 'GuestHomepage.html'%}
     
     {% block body %}
     <section class="Main">
         <section class="add-product-page">
             <div class="leftside-of-add-product-page">
                <h1 style="font-size: 40px;">Vendor</h1><br>
                {% if success == True %}
                    <h2 style="color: green; margin: 0%;">{{ message }}</h2>
                {% elif success == False %}
                    <h2 style="color: red; margin: 0%;">{{ message }}</h2>
                <!-- {% elif successinv == True%}
                    <h2 style="color: green; margin: 0%;">{{ messageinv }}</h2>
                {% elif successinv == False%}
                    <h2 style="color: green; margin: 0%;">{{ messageinv }}</h2> -->
                {% endif %}
             </div>
     
             <form class="form-css form1" method="POST" action="{{ url_for('vendor_bp.VendorAddProduct') }}">
                <h1 class="modal-title">Add Product</h1>
            
                <label for="URL">Image URL:</label>
                <input type="url" name="URL" placeholder="IMG" required>
            
                <label for="title">Product Title:</label>
                <input type="text" name="title" placeholder="Title" required>
            
                <label for="price">Price:</label>
                <input type="number" name="price" step="0.01" placeholder="Price" required>
            
                <label for="description">Description:</label>
                <input type="text" name="description" placeholder="Description" required>
            
                <label>Do you want to add a Warranty?</label>
                <div>
                    <input type="radio" name="add_warranty" value="yes" onclick="toggleWarrantyFields(this, true)" required>
                    <label>Yes</label>
                    <input type="radio" name="add_warranty" value="no" onclick="toggleWarrantyFields(this, false)">
                    <label>No</label>
                </div>
            
                <div class="warranty_field_css" style="display: none;">
                    <label>Warranty:</label>
                    <input type="date" name="warranty">
                </div>
            
                <label>Do you want to add a discount?</label>
                <div>
                    <input type="radio" name="add_discount" value="yes" onclick="toggleDiscountFields(this, true)" required>
                    <label>Yes</label>
                    <input type="radio" name="add_discount" value="no" onclick="toggleDiscountFields(this, false)">
                    <label>No</label>
                </div>
            
                <div class="discount_field_css" style="display: none;">
                    <label>Discount (%):</label>
                    <input type="number" name="discount" placeholder="Discount">
                    <label>Discount End Date:</label>
                    <input type="date" name="discount_date">
                </div>
            
                <label for="availability">Availability:</label>
                <select name="availability" required>
                    <option value="" disabled selected>Select availability</option>
                    <option value="IN STOCK">IN STOCK</option>
                    <option value="OUT OF STOCK">OUT OF STOCK</option>
                </select>
                <input type="submit" value="Add Product to Acadia">
            </form>
            
         </section>
        
         <section class="vendor-Products"> 
            <h1>Your Products</h1>
            <div class="grid-products">
                {% for Product in AllProducts %}
                <div class="product-card">
                    <div class="img-title-holder">
                        <!-- Main Product Image -->
                        <div class="img-contrainter" style="margin-bottom: 10px;">
                            <img src="{{ Product['image_url'] }}" alt="Main Product Image" id="main-image-{{ Product['product_id'] }}">
                        </div>
                        
                        <!-- Thumbnail Bar -->
                        <div class="thumbnail-bar">
                            <!-- Main Thumbnail Image -->
                            <div class="thumbnail placeholder-thumb">
                                <div class="thumbnail-item">
                                    <img src="{{ Product['image_url'] or 'https://via.placeholder.com/200' }}" alt="Main Product Image" class="img-holder"
                                         onclick="changeImage('{{ Product['image_url'] }}', '{{ Product['product_id'] }}')">
                                </div>
                            </div>
                            
                            <!-- Additional Thumbnails -->
                            {% for img, img_id in Product['additional_images'] %}
                            <div class="thumbnail placeholder-thumb">
                                <div class="thumbnail-item">
                                    <img src="{{ img }}" alt="Thumbnail" class="thumbnail" 
                                         onclick="changeImage('{{ img }}', '{{ Product['product_id'] }}')">
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        
                        <!-- Product Title -->
                        <div class="title">
                            <h3>{{ Product['title'] }}</h3>
                        </div>
                    </div>
                    <div class="price-holder">
                        {% if (Product.discount_date and Product.discount_date > CurDate) and Product.discount %}
                            <div>
                                <div class="price"><p>Original Price: ${{ '%0.2f' | format(Product.price | float) }}</p></div>
                                <div class="price"><p style="color: rgb(255, 0, 0);">Amount dropped: -${{ '%0.2f' | format(Product.saving_discount | float) }}</p></div>
                                <div class="price"><p style="color: green;">Discounted Price: ${{ '%0.2f' | format(Product.discounted_price | float) }}</p></div>
                            </div>
                        {% elif Product.discount_date and Product.discount_date < CurDate %}
                            <div>
                                <div class="price"><p>Original Price: ${{ '%0.2f' | format(Product.price | float) }}</p></div>
                                <div class="price"><p style="color: orange;">Discount expired!</p></div>
                            </div>
                        {% else %}
                            <div>
                                <div class="price"><p>Original Price: ${{ '%0.2f' | format(Product.price | float) }}</p></div>
                                <div class="price"><p>No discount added</p></div>
                            </div>
                        {% endif %}
                        <div class="button-holder">
                            <button onclick="OpenEditProductModal('{{ Product['product_id'] }}')" class="edit-button">Edit Control</button>  
                            <button onclick="OpenModal('{{ Product['product_id'] }}')" class="edit-button">Product Control</button>                               
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>
    
         
    <!-- ##################################################### -->
    <!-- ###                                               ### -->
    <!-- ###                     MODALS                    ### -->
    <!-- ###                                               ### -->
    <!-- ##################################################### -->
    
    <!-- Options Modal Structure -->
    <div id="OptionsModal" class="modal" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title" id="accountModalLabel">Product Options</h1>
                    <p>Pid: <span id="modal-PID"></span></p>
                    <p style="margin: 0; color: rgb(136, 136, 136);">fill in what your product needs</p>
                </div>
                <div class="modal-body Options-body">
                    <div class="modal-button-holder Options-button-holder">
                        <button class="inventory-button" onclick="OpenDeleteModal()">Delete Product</button>
                        <button class="inventory-button" onclick="OpenImageModal()">Add Images</button>
                        <button class="inventory-button" onclick="OpenEditImageModal()">Edit Images</button>
                        <button class="inventory-button" onclick="OpenEditInvetoryModal()">Edit Inventory Item</button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="CloseModal()">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit Product Modal -->
    <div id="EditProductModal" class="modal" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">  
                    <h1 class="modal-title">Edit Product</h1>
                    <p>Pid: <span id="edit-modal-PID"></span></p>
                    <p style="margin: 0; color: rgb(136, 136, 136);">Fill in what your product needs</p>
                </div>
                <div class="modal-body">
                    {% for product in AllProducts %}
                    <form class="form-css edit-form product-edit-form" id="form-{{ product['product_id'] }}" data-pid="{{ product['product_id'] }}" method="POST" action="{{ url_for('vendor_bp.VendorEditProduct') }}" style="display: none;">
                        <div class="left-side-form">
                            <input type="hidden" name="PID" value="{{ product['product_id'] }}">
                            
                            <div>
                                <label>Main Image URL:</label>
                                <input type="url" name="URL" value="{{ product['image_url'] }}" required>
                            </div>

                            <div>
                                <label>Product Title:</label>
                                <input type="text" name="title" value="{{ product['title'] }}" required>
                            </div>

                            <div>
                                <label>Price:</label>
                                <input type="number" name="price" step="0.01" value="{{ product['price'] }}" required>
                            </div>

                            <div>
                                <label>Description:</label>
                                <input type="text" name="description" value="{{ product['description'] }}" required>
                            </div>
                        </div>
                        <div class="right-side-form">
                            <div>
                                <label>Do you want to add a Warranty?</label>
                                <div class="radio-group-horizontal">
                                    <div class="radio-option">
                                        <input type="radio" name="add_warranty" value="yes" onclick="toggleWarrantyFields(this, true)" {% if product['warranty'] %}checked{% endif %}>
                                        <label>Yes</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" name="add_warranty" value="no" onclick="toggleWarrantyFields(this, false)" {% if not product['warranty'] %}checked{% endif %}>
                                        <label>No</label>
                                    </div>
                                </div>
            
                                <div class="warranty_field_css" style="display: {{ 'flex' if product['warranty'] else 'none' }};">
                                    <label>Warranty:</label>
                                    <input type="date" name="warranty" value="{{ product['warranty'] }}">
                                </div>
                            </div>
                        <div>
                            <label>Do you want to add a discount?</label>
                            <div class="radio-group-horizontal">
                                <div class="radio-option">
                                    <input type="radio" name="add_discount" value="yes" onclick="toggleDiscountFields(this, true)" {% if product['discount'] %}checked{% endif %}>
                                    <label>Yes</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" name="add_discount" value="no" onclick="toggleDiscountFields(this, false)" {% if not product['discount'] %}checked{% endif %}>
                                    <label>No</label>
                                </div>
                            </div>
                            
                            
                            <div class="discount_field_css" style="display: {{ 'flex' if product['discount'] else 'none' }};">
                                <label>Discount (%):</label>
                                <input type="number" name="discount" value="{{ product['discount'] | float * 100 if product['discount'] else '' }}">
                                <label>Discount End Date:</label>
                                <input type="date" name="discount_date" value="{{ product['discount_date'] }}">
                            </div>
                        </div>

                        <div>
                            <label for="availability">Availability:</label><br>
                            <select name="availability" required>
                                <option value="IN STOCK" {% if product['availability'] == "IN STOCK" %}selected{% endif %}>IN STOCK</option>
                                <option value="OUT OF STOCK" {% if product['availability'] == "OUT OF STOCK" %}selected{% endif %}>OUT OF STOCK</option>
                            </select>
                        </div>

                        <div>
                            <label for="VID">Vendor ID:</label>
                            <input type="number" name="VID" value="{{ product['VID'] }}" required>
                        </div>
                        <input type="submit" value="Update Product">
                    </div>
                    </form>    
                    {% endfor %}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="CloseEditProductModal()">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    
    
    <!-- Delete Product Modal Structure -->
    <div id="DeleteProductModal" class="modal" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title" id="accountModalLabel">Delete Product</h1>
                    <p style="margin: 0; color: rgb(136, 136, 136);">fill in what your product needs</p>
                </div>
                <div class="modal-body">
                    <!-- Form for Deleting product -->
                    <form class="Inventory-form"  action="{{ url_for('vendor_bp.VendorDeleteProduct') }}" method="POST">
                        <input type="hidden" id="del-modal-PID-input" name="PID">
                        <!-- <input type="hidden" id="del-modal-VID-input" name="VID"> -->
                        <label for="PID">Product ID: <span id="del-modal-PID"></span></label>
                        
                        <button type="submit" class="btn btn-primary">Delete Product</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="CloseDeleteModal()">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Image Modal Structure -->
    <div id="AddImageModal" class="modal" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title">Add Product Images</h1>
                    <p style="margin: 0; color: rgb(136, 136, 136);">Upload additional images</p>
                </div>
                <div class="modal-body">
                    <!-- Form for adding product images -->
                    <form class="Inventory-form" method="POST" action="{{ url_for('vendor_bp.AddImages') }}" enctype="multipart/form-data">
                        <label for="image_PID">Product ID: <span id="img-modal-PID"></span></label>
                        <input type="hidden" id="img-modal-PID-input" name="PID">

                        <label for="image_url">Enter Image URL:</label>
                        <input type="url" id="image_url" name="image_url" placeholder="https://example.com/image.jpg">
                        <button type="submit" class="btn btn-primary">Upload Image</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="CloseImageModal()">Close</button>
                </div>
            </div>
        </div>
    </div>
        
        <!-- Edit Image Modal Structure -->
    <div id="EditImageModal" class="modal" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content edit-image-content">
                <div class="modal-header">
                    <h1 class="modal-title">Edit Product Images</h1>
                    <p style="margin: 0; color: rgb(136, 136, 136);">Upload additional images</p>
                </div>
                <div class="modal-body">
                    <!-- Form for adding product images -->
                    <form class="Inventory-form" method="POST" action="{{ url_for('vendor_bp.VendorEditProductImages') }}" enctype="multipart/form-data">
                        
                        <!-- Hidden fields dynamically set via JS -->
                        <!-- <input type="hidden" id="edit-image-pid" name="PID">
                        <input type="hidden" id="edit-image-id" name="image_ids"> -->
                        

                        <label for="image_url">Product ID: <span id="edit-img-modal-PID-input"></span></label>
                        <label for="pi-img-id">Image ID: <span id="pi-img-id"></span></label>

                        {% for product in AllProducts %}
                            <div class="product-images-group" data-pid="{{ product['product_id'] }}" style="display: none;">
                                {% if product['additional_images'] %}
                                    <!-- Modal Image Section -->
                                    <div class="img-contrainter-modal" style="margin-bottom: 10px;">
                                        <img src="{{ product['image_url'] }}" style="margin-bottom: 10px; width: 300px; height: auto;" alt="Main product Image" id="main-modal-image-{{ product['product_id'] }}">
                                    </div>
                                    <!-- Thumbnail Section -->
                                    <div class="thumbnail-bar">
                                        <div class="thumbnail placeholder-thumb" style="justify-content: center;">
                                            <div class="thumbnail-item" style="width:auto;">
                                                <img src="{{ product['image_url'] or 'https://via.placeholder.com/200' }}" alt="Main product Image" class="thumbnail"
                                                    onclick="changeModalImage('{{ product['image_url'] }}', '{{ product['product_id'] }}', 'main')">
                                            </div>
                                        </div>
                                        {% for img, img_id in product['additional_images'] %}
                                            <div class="thumbnail placeholder-thumb" style="justify-content: center;">
                                                <div class="thumbnail-item" style="width:auto;">
                                                    <img src="{{ img }}" alt="Thumbnail" class="thumbnail"
                                                        onclick="changeModalImage('{{ img }}', '{{ product['product_id'] }}', '{{ img_id }}')">
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <p>No additional images.</p>
                                {% endif %}
                            </div>
                        {% endfor %}

                        <label for="image_url">Enter Image URL:</label>
                        <input type="url" id="edit-image-url" name="image_url" placeholder="https://example.com/image.jpg">
                        <button type="submit" class="btn btn-primary">Update Image</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="CloseEditImageModal()">Close</button>
                </div>
            </div>
        </div>
    </div>

        
        <!-- Add Inventory Modal Structure -->
        <div id="InventoryModal" class="modal" style="display: none;">
            <div class="modal-dialog">
                <div class="modal-content edit-image-content">
                    <div class="modal-header">
                        <h1 class="modal-title">Add Inventory Item</h1>
                        <p style="margin: 0; color: rgb(136, 136, 136);">Add Inventory to Product</p>
                    </div>
                    <div class="modal-body">
                        <!-- Form for adding product images -->
                        <form class="Inventory-form" method="POST" action="{{ url_for('vendor_bp.AddInventory') }}" enctype="multipart/form-data">
                            
                            <!-- Hidden fields dynamically set via JS -->
                            <input type="hidden" id="edit-image-pid" name="PID">
                            <input type="hidden" id="edit-image-id" name="image_ids">
                            <input type="hidden" id="edit-image-url" name="image_url">
                            
            
                            <label for="image_url">Product ID: <span id="add-inv-modal-PID-input"></span></label>
                            <label for="pi-img-id-inv">Image ID: <span id="pi-img-id-inv"></span></label>
            
                            {% for product in AllProducts %}
                                <div class="product-images-group-inv" data-pid="{{ product['product_id'] }}" style="display: none;">
                                        <!-- Modal Image Section -->
                                        <div class="img-contrainter-modal" style="margin-bottom: 10px;">
                                            <img src="{{ product['image_url'] }}" style="margin-bottom: 10px; width: 300px; height: auto;" alt="Main product Image" id="main-modal-image-inv-{{ product['product_id'] }}">
                                        </div>
                                        <!-- Thumbnail Section -->
                                        <div class="thumbnail-bar">
                                            <div class="thumbnail placeholder-thumb" style="justify-content: center;">
                                                <div class="thumbnail-item" style="width:auto;">
                                                    <img src="{{ product['image_url'] or 'https://via.placeholder.com/200' }}" alt="Main product Image" class="thumbnail"
                                                        onclick="changeModalImageInv('{{ product['image_url'] }}', '{{ product['product_id'] }}', 'main')">
                                                </div>
                                            </div>
                                            {% for img, img_id in product['additional_images'] %}
                                                <div class="thumbnail placeholder-thumb" style="justify-content: center;">
                                                    <div class="thumbnail-item" style="width:auto;">
                                                        <img src="{{ img }}" alt="Thumbnail" class="thumbnail"
                                                        onclick="changeModalImageInv('{{ img }}', '{{ product['product_id'] }}', '{{ img_id }}')">
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </div>
                                </div>
                            {% endfor %}
                            <label for="Color">Color:</label>
                            <input type="text" id="Color" name="Color" placeholder="Enter Color" required>
            
                            <label for="Amount">Amount:</label>
                            <input type="number" id="Amount" name="Amount" placeholder="Enter Amount" required>
                            
                            <button type="submit" class="btn btn-primary">add inventory to product</button>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="CloseInventoryModal()">Close</button>
                    </div>
                </div>
            </div>
        </div>
        
        
    <!-- Edit Inventory Modal -->
    <div id="EditInventoryModal" class="modal" style="display: none;">
        <div class="modal-dialog">
        <div class="modal-content edit-image-content">
            <div class="modal-header">
            <h1 class="modal-title">Edit Inventory for Item</h1>
            <p style="margin: 0; color: rgb(136, 136, 136);">Edit Inventory for Product</p>
            </div>
            <div class="modal-body">
            <form class="Inventory-form" method="POST" action="{{ url_for('vendor_bp.editInventory') }}" enctype="multipart/form-data">
                <input type="hidden" id="edit-inventory-pid" name="PID">
                <input type="hidden" id="edit-inventory-image-id" name="image_ids">
                <input type="hidden" id="edit-inventory-image-url" name="image_url">
    
                <label>Product ID: <span id="edit-inv-modal-PID-input"></span></label>
                <label>Image ID: <span id="pi-img-id-edit-inv"></span></label>
    
                <div>
                <label for="Color">Color:</label>
                <input type="text" id="Color" name="Color" placeholder="Enter Color" required>
                </div>
    
                <div>
                <label for="Amount">Amount:</label>
                <input type="number" id="Amount" name="Amount" placeholder="Enter Amount" required>
                </div>
    
                {% for product in AllProducts %}
                <div class="product-images-group-edit-inv" data-pid="{{ product['product_id'] }}" style="display: none;">
                    <div class="img-contrainter-modal" style="margin-bottom: 10px;">
                    <img src="{{ product['image_url'] }}" style="margin-bottom: 10px; width: 300px; height: auto;" alt="Main product Image" id="main-modal-image-edit-inv-{{ product['product_id'] }}">
                    </div>
    
                    <div class="thumbnail-bar">
                    {% set main_inv = product['main_inventory'][0] if product['main_inventory'] else {} %}
                    <div class="thumbnail placeholder-thumb" style="justify-content: center;">
                        <div class="thumbnail-item" style="width:auto;">
                        <img src="{{ product['image_url'] or 'https://via.placeholder.com/200' }}" alt="Main product Image" class="thumbnail"
                            onclick="changeModalImageEditInv('{{ product['image_url'] }}', '{{ product['product_id'] }}', 'main', '{{ main_inv.color or '' }}', '{{ main_inv.amount or 0 }}')">
                        </div>
                    </div>
    
                    {% for img, img_id in product['additional_images'] %}
                        {% set inventory = product['inventory_map'].get(img_id, {}) %}
                        <div class="thumbnail placeholder-thumb" style="justify-content: center;">
                        <div class="thumbnail-item">
                            <img src="{{ img }}" alt="Thumbnail" class="thumbnail"
                                onclick="changeModalImageEditInv('{{ img }}', '{{ product['product_id'] }}', '{{ img_id }}', '{{ inventory.color or '' }}', '{{ inventory.amount or 0 }}')">
                        </div>
                        </div>
                    {% endfor %}
                    </div>
                </div>
                {% endfor %}
    
                <button type="submit" class="btn btn-primary">Update Inventory</button>
            </form>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="CloseEditInventoryModal()">Close</button>
            </div>
        </div>
        </div>
    </div>

</section>
     
     <script>
    function toggleDiscountFields(el, show) {
        const form = el.closest("form");
        const discountFields = form.querySelector('.discount_field_css');
    
        if (discountFields) {
            discountFields.style.display = show ? 'flex' : 'none';
    
            const discountInput = form.querySelector('input[name="discount"]');
            const discountDateInput = form.querySelector('input[name="discount_date"]');
    
            if (discountInput) discountInput.required = show;
        }
    }
    
    function toggleWarrantyFields(el, show) {
        const form = el.closest("form");
        const warrantyFields = form.querySelector('.warranty_field_css');
    
        if (warrantyFields) {
            warrantyFields.style.display = show ? 'flex' : 'none';
    
            const warrantyInput = form.querySelector('input[name="warranty"]');
            if (warrantyInput) warrantyInput.required = show;
        }
    }
    
    
        let currentPID = null; // Global variable to store the current PID
    
        function OpenEditProductModal() {
            const pid = currentPID;
            window.location.href = `/vendor/AddProduct?edit_pid=${pid}`;
        }   
    
        // Options modal
        window.OpenModal = function(PID) {
        currentPID = PID; // Store the PID in the global variable
        console.log("Current PID:", currentPID); // Debugging log
        let modal = document.querySelector("#OptionsModal");
        modal.style.display = "flex"; // Show the modal
    
        // Update the PID in the span element
        const pidSpan = document.getElementById("modal-PID");
        if (pidSpan) {
            pidSpan.textContent = currentPID; // Set the text content of the span
        }
    };
    
        window.CloseModal = function() {
            let modal = document.querySelector("#OptionsModal");
            modal.style.display = "none"; // Hide the modal
        };
    
        // Edit Product Modal
        window.OpenEditProductModal = function(PID) {
            const modal = document.querySelector("#EditProductModal");
            modal.style.display = "flex";
    
            const pidSpan = document.getElementById("edit-modal-PID");
            if (pidSpan) {
                pidSpan.textContent = PID;
            }
    
            // Hide all forms
            document.querySelectorAll(".product-edit-form").forEach(form => {
                form.style.display = "none";
            });
    
            // Show the one that matches
            const targetForm = document.getElementById("form-" + PID);
            if (targetForm) {
                targetForm.style.display = "flex";
            }
        };
    
        window.CloseEditProductModal = function() {
            const modal = document.querySelector("#EditProductModal");
            modal.style.display = "none";
        };
        // Delete Product Modal
        window.OpenDeleteModal = function(PID) {
            if (typeof PID === 'undefined' || PID === null) {
                PID = currentPID;
            } else {
                currentPID = PID;
            }
            
            let modal = document.querySelector("#DeleteProductModal");
            if (!modal) {
                console.error("DeleteProductModal element not found!");
                return;
            }
            
            // Store the PID directly in the modal's data attribute
            modal.setAttribute("data-pid", PID);
            
            let productIdInput = document.querySelector("#PID");
            if (productIdInput) {
                productIdInput.value = PID;
            }
            
            const pidSpan = document.getElementById("del-modal-PID");
            if (pidSpan) {
                pidSpan.textContent = PID;
            }
            
            // Update the modal with PID
            document.getElementById("del-modal-PID").textContent = PID;

            // Set values in hidden inputs
            const pidInput = document.getElementById("del-modal-PID-input");
            if (pidInput) pidInput.value = PID;
            
            modal.style.display = "flex";
        };
    
        window.CloseDeleteModal = function() {
            let modal = document.querySelector("#DeleteProductModal");
            modal.style.display = "none"; // Hide the modal
        };
    
        // Add Image Modal
        window.OpenImageModal = function(PID) {
            if (typeof PID === 'undefined' || PID === null) {
                PID = currentPID;
            } else {
                currentPID = PID;
            }

            let modal = document.querySelector("#AddImageModal");
            modal.setAttribute("data-pid", PID);

            
            let productIdInput = document.querySelector("#PID");
            if (productIdInput) {
                productIdInput.value = PID;
            }

            const pidSpan = document.getElementById("img-modal-PID");
            if (pidSpan) {
                pidSpan.textContent = PID;
            }
            
            // Update the modal with PID
            document.getElementById("img-modal-PID").textContent = PID;

            // Set values in hidden inputs
            const pidInput = document.getElementById("img-modal-PID-input");
            if (pidInput) pidInput.value = PID;

            modal.style.display = "flex";
        };
    
        window.CloseImageModal = function() {
            let modal = document.querySelector("#AddImageModal");
            modal.style.display = "none";
        };
    
    
        // Edit Image Modal
    window.OpenEditImageModal = function(PID) {
        if (typeof PID === 'undefined' || PID === null) {
            PID = currentPID;
        } else {
            currentPID = PID;
        }

        let modal = document.querySelector("#EditImageModal");
        modal.setAttribute("data-pid", PID);

        let productIdInput = document.querySelector("#image_PID");
        if (productIdInput) {
            productIdInput.value = PID;
        }

        document.getElementById("edit-img-modal-PID-input").textContent = PID;

        // Hide all image groups
        document.querySelectorAll('.product-images-group').forEach(group => {
            group.style.display = 'none';
        });

        // Show only the one with the matching PID
        const selectedGroup = document.querySelector(`.product-images-group[data-pid="${PID}"]`);
        if (selectedGroup) {
            selectedGroup.style.display = 'block';
        }

        modal.style.display = "flex";
    };


    window.CloseEditImageModal = function() {
        document.getElementById("EditImageModal").style.display = "none";
    };
    

    
        // Edit Inventory Modal
        window.OpenEditInvetoryModal = function(PID) {
            if (!PID) {
                PID = currentPID;
            } else {
                currentPID = PID;
            }

            const modal = document.querySelector("#EditInventoryModal");
            modal.setAttribute("data-pid", PID);

            // Set visible text
            const pidSpan = document.getElementById("edit-inv-modal-PID-input");
            if (pidSpan) pidSpan.textContent = PID;

            // Hide all previous image groups
            document.querySelectorAll('.product-images-group-edit-inv').forEach(group => {
                group.style.display = 'none';
            });

            // Show the one for this PID
            const selectedGroup = document.querySelector(`.product-images-group-edit-inv[data-pid="${PID}"]`);
            if (selectedGroup) {
                selectedGroup.style.display = 'block';
            }

            modal.style.display = "flex";
        };
   
        window.CloseEditInventoryModal = function() {
            const modal = document.querySelector("#EditInventoryModal");
            if (modal) modal.style.display = "none";

            // Optional: clear fields
            document.getElementById("edit-inventory-pid").value = "";
            document.getElementById("edit-inventory-image-id").value = "";
            document.getElementById("edit-inventory-image-url").value = "";
            document.getElementById("pi-img-id-edit-inv").textContent = "";
            document.getElementById("edit-inv-modal-PID-input").textContent = "";

            const colorInput = document.querySelector('#EditInventoryModal input[name="Color"]');
            const amountInput = document.querySelector('#EditInventoryModal input[name="Amount"]');
            if (colorInput) colorInput.value = "";
            if (amountInput) amountInput.value = "";
        };
    
       
    
        function changeImage(imageUrl, productId) {
        const mainImage = document.getElementById(`main-image-${productId}`);
            if (mainImage) {
                mainImage.src = imageUrl;
            }

           

            const mainImageEditInv = document.getElementById(`main-image-edit-inv-${productId}`);
            if (mainImageInv) {
                mainImageInv.src = imageUrl;
            }
        }
        function changeModalImage(imageUrl, productId, imageId) {
            // Update the main image preview
            const mainModalImage = document.getElementById(`main-modal-image-${productId}`);
            if (mainModalImage) {
                mainModalImage.src = imageUrl;
            }

            // Update hidden form fields
            document.getElementById('edit-image-pid').value = productId;
            document.getElementById('edit-image-id').value = imageId;
            document.getElementById('edit-image-url').value = imageUrl;

            // Update visible span values (optional)

            const pidSpan = document.getElementById('edit-img-modal-PID-input');
            if (pidSpan) pidSpan.textContent = productId;

            const imgIdSpan = document.getElementById('pi-img-id');
            if (imgIdSpan) imgIdSpan.textContent = imageId;

        }
        function changeModalImageEditInv(imageUrl, productId, imageId, color = '', amount = 0) {
            const mainModalImage = document.getElementById(`main-modal-image-edit-inv-${productId}`);
            if (mainModalImage) mainModalImage.src = imageUrl;

            document.getElementById('edit-inventory-pid').value = productId;
            document.getElementById('edit-inventory-image-id').value = imageId;
            document.getElementById('edit-inventory-image-url').value = imageUrl;

            const pidSpan = document.getElementById('edit-inv-modal-PID-input');
            if (pidSpan) pidSpan.textContent = productId;

            const imgIdSpan = document.getElementById('pi-img-id-edit-inv');
            if (imgIdSpan) imgIdSpan.textContent = imageId;

            const colorInput = document.querySelector('#EditInventoryModal input[name="Color"]');
            const amountInput = document.querySelector('#EditInventoryModal input[name="Amount"]');
            if (colorInput) colorInput.value = color;
            if (amountInput) amountInput.value = amount;
        }


        
     </script> 
     {% endblock body%}